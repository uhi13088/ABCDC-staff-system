================================================================================
íŒŒì¼ëª…: .github/workflows/test.yml
ì„¤ëª…: Jest ìë™ í…ŒìŠ¤íŠ¸ ì›Œí¬í”Œë¡œìš° (PR/Push ì‹œ ìë™ ì‹¤í–‰)
================================================================================

name: Jest ìë™ í…ŒìŠ¤íŠ¸

# íŠ¸ë¦¬ê±°: main ë¸Œëœì¹˜ push, ëª¨ë“  Pull Request
on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

jobs:
  test:
    name: í…ŒìŠ¤íŠ¸ ì‹¤í–‰
    runs-on: ubuntu-latest
    
    strategy:
      matrix:
        node-version: [18.x, 20.x]
    
    steps:
      # 1. ì½”ë“œ ì²´í¬ì•„ì›ƒ
      - name: ğŸ“¥ ì½”ë“œ ì²´í¬ì•„ì›ƒ
        uses: actions/checkout@v4
      
      # 2. Node.js ì„¤ì •
      - name: ğŸŸ¢ Node.js ${{ matrix.node-version }} ì„¤ì •
        uses: actions/setup-node@v4
        with:
          node-version: ${{ matrix.node-version }}
          cache: 'npm'
      
      # 3. ì˜ì¡´ì„± ì„¤ì¹˜
      - name: ğŸ“¦ ì˜ì¡´ì„± ì„¤ì¹˜
        run: npm ci
      
      # 4. Jest í…ŒìŠ¤íŠ¸ ì‹¤í–‰
      - name: ğŸ§ª Jest í…ŒìŠ¤íŠ¸ ì‹¤í–‰
        run: npm test
      
      # 5. ì»¤ë²„ë¦¬ì§€ ë¦¬í¬íŠ¸ ìƒì„±
      - name: ğŸ“Š ì»¤ë²„ë¦¬ì§€ ë¦¬í¬íŠ¸ ìƒì„±
        run: npm run test:coverage
      
      # 6. ì»¤ë²„ë¦¬ì§€ ì—…ë¡œë“œ (Codecov)
      - name: ğŸ“¤ Codecovì— ì»¤ë²„ë¦¬ì§€ ì—…ë¡œë“œ
        uses: codecov/codecov-action@v4
        with:
          token: ${{ secrets.CODECOV_TOKEN }}
          files: ./coverage/lcov.info
          flags: unittests
          name: codecov-umbrella
          fail_ci_if_error: false
      
      # 7. í…ŒìŠ¤íŠ¸ ê²°ê³¼ ì•„í‹°íŒ©íŠ¸ ì €ì¥
      - name: ğŸ’¾ í…ŒìŠ¤íŠ¸ ê²°ê³¼ ì €ì¥
        if: always()
        uses: actions/upload-artifact@v4
        with:
          name: test-results-node-${{ matrix.node-version }}
          path: |
            coverage/
            jest-results.json
          retention-days: 30


================================================================================
íŒŒì¼ëª…: .github/workflows/code-quality.yml
ì„¤ëª…: ì½”ë“œ í’ˆì§ˆ ê²€ì‚¬ ì›Œí¬í”Œë¡œìš° (PR ì‹œ ì»¤ë²„ë¦¬ì§€ ê²€ì¦)
================================================================================

name: ì½”ë“œ í’ˆì§ˆ ê²€ì‚¬

on:
  pull_request:
    branches: [ main ]

jobs:
  lint:
    name: ì½”ë“œ í’ˆì§ˆ ë¶„ì„
    runs-on: ubuntu-latest
    
    steps:
      - name: ğŸ“¥ ì½”ë“œ ì²´í¬ì•„ì›ƒ
        uses: actions/checkout@v4
      
      - name: ğŸŸ¢ Node.js ì„¤ì •
        uses: actions/setup-node@v4
        with:
          node-version: '20.x'
          cache: 'npm'
      
      - name: ğŸ“¦ ì˜ì¡´ì„± ì„¤ì¹˜
        run: npm ci
      
      # ì»¤ë²„ë¦¬ì§€ ì„ê³„ê°’ ê²€ì¦
      - name: ğŸ“Š ì»¤ë²„ë¦¬ì§€ ì„ê³„ê°’ ê²€ì¦
        run: npm run test:coverage
      
      - name: ğŸ“ˆ ì»¤ë²„ë¦¬ì§€ ë¦¬í¬íŠ¸ ì½”ë©˜íŠ¸
        uses: romeovs/lcov-reporter-action@v0.3.1
        if: github.event_name == 'pull_request'
        with:
          lcov-file: ./coverage/lcov.info
          github-token: ${{ secrets.GITHUB_TOKEN }}
          title: "í…ŒìŠ¤íŠ¸ ì»¤ë²„ë¦¬ì§€ ë¦¬í¬íŠ¸"


================================================================================
ì‚¬ìš© ë°©ë²•
================================================================================

1. GitHub ì›¹ì‚¬ì´íŠ¸ ì ‘ì†
   https://github.com/uhi13088/ABCDC-staff-system

2. Actions íƒ­ í´ë¦­

3. "New workflow" ë˜ëŠ” "set up a workflow yourself" í´ë¦­

4. íŒŒì¼ ìƒì„±
   - ì²« ë²ˆì§¸ íŒŒì¼: .github/workflows/test.yml
   - ë‘ ë²ˆì§¸ íŒŒì¼: .github/workflows/code-quality.yml

5. ìœ„ ë‚´ìš©ì„ ê°ê° ë³µì‚¬í•´ì„œ ë¶™ì—¬ë„£ê¸°

6. "Commit changes" í´ë¦­

7. ì™„ë£Œ!


================================================================================
ì£¼ì˜ì‚¬í•­
================================================================================

- CODECOV_TOKEN: Codecov ì‚¬ìš© ì‹œ í•„ìš” (ì„ íƒì‚¬í•­)
  â†’ ì‚¬ìš©í•˜ì§€ ì•Šìœ¼ë©´ í•´ë‹¹ stepì€ ìë™ìœ¼ë¡œ ì‹¤íŒ¨í•˜ì§€ë§Œ ì „ì²´ ì›Œí¬í”Œë¡œìš°ëŠ” ê³„ì† ì§„í–‰ë¨

- GITHUB_TOKEN: ìë™ ì œê³µë¨ (ë³„ë„ ì„¤ì • ë¶ˆí•„ìš”)

- ì´ íŒŒì¼ë“¤ì„ ì¶”ê°€í•˜ë©´ PR/Push ì‹œ ìë™ìœ¼ë¡œ í…ŒìŠ¤íŠ¸ê°€ ì‹¤í–‰ë©ë‹ˆë‹¤.
