# SSOT (Single Source of Truth) ì•„í‚¤í…ì²˜

## ğŸ¯ í•µì‹¬ ì² í•™

> **"ì½ì„ ë•Œ ê³„ì‚°í•˜ì§€ ë§ê³ , ì“¸ ë•Œ ê³„ì‚°í•´ì„œ ì €ì¥í•˜ë¼"**

ëª¨ë“  íŒŒìƒ ë°ì´í„°(ê¸‰ì—¬, ê·¼ë¬´ì‹œê°„, ëŒ€ì‹œë³´ë“œ í˜„í™©)ëŠ” **ê·¼íƒœ ê¸°ë¡ ì €ì¥ ì‹œì ì— ì¦‰ì‹œ ê³„ì‚°**ë˜ì–´ DBì— ì €ì¥ë©ë‹ˆë‹¤.  
ì¡°íšŒ ì‹œì ì—ëŠ” **ë‹¨ìˆœ ì§‘ê³„(sum, count)**ë§Œ ìˆ˜í–‰í•˜ì—¬ ì„±ëŠ¥ì„ ìµœì í™”í•©ë‹ˆë‹¤.

---

## ğŸ“ ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    User Interaction                         â”‚
â”‚              (ì¶œê·¼/í‡´ê·¼ ë²„íŠ¼ í´ë¦­, ê¸‰ì—¬ ì¡°íšŒ)                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               Frontend Components                           â”‚
â”‚        (View-Only: ì½ê¸° ì „ìš©, ê³„ì‚° ì—†ìŒ)                    â”‚
â”‚  - DashboardTab: ëŒ€ì‹œë³´ë“œ í˜„í™© í‘œì‹œ                         â”‚
â”‚  - SalaryTab: ê¸‰ì—¬ í…Œì´ë¸” í‘œì‹œ + ì¡°íšŒ ë²„íŠ¼                  â”‚
â”‚  - AttendanceTab: ê·¼íƒœ ëª©ë¡ í‘œì‹œ                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 Hooks (State Management)                    â”‚
â”‚  - useSalaryLogic: ê¸‰ì—¬ ì§‘ê³„ (sum)                          â”‚
â”‚  - useDashboardLogic: ëŒ€ì‹œë³´ë“œ ì§‘ê³„ (sum, count)            â”‚
â”‚  - useAttendanceLogic: ê·¼íƒœ ëª©ë¡ ì¡°íšŒ                       â”‚
â”‚  - useSalaryRealtime: ì‹¤ì‹œê°„ êµ¬ë… (onSnapshot)              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚             Service Layer (Business Logic)                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚   AttendanceService (The Brain ğŸ§ )                  â”‚   â”‚
â”‚  â”‚   - clockIn: ìŠ¤ì¼€ì¤„ ë§¤ì¹­, ì§€ê° íŒë‹¨                 â”‚   â”‚
â”‚  â”‚   - clockOut: ì¼ê¸‰ ìë™ ê³„ì‚°, ì¡°í‡´ íŒë‹¨             â”‚   â”‚
â”‚  â”‚   - updateAttendance: ì¬ê³„ì‚° + ì•Œë¦¼                â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚   SalaryService (The Viewer ğŸ‘ï¸)                    â”‚   â”‚
â”‚  â”‚   - getMonthlySalary: dailyWage í•©ì‚°               â”‚   â”‚
â”‚  â”‚   - subscribeMonthlySalary: ì‹¤ì‹œê°„ êµ¬ë…            â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 Firestore Database                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ attendance (SSOT - Single Source of Truth)          â”‚  â”‚
â”‚  â”‚  - clockIn, clockOut (Timestamp)                    â”‚  â”‚
â”‚  â”‚  - scheduledStartTime, scheduledEndTime (HH:mm)     â”‚  â”‚
â”‚  â”‚  - workMinutes (ìë™ ê³„ì‚°)                           â”‚  â”‚
â”‚  â”‚  - basePay, overtimePay, nightPay, holidayPay       â”‚  â”‚
â”‚  â”‚  - dailyWage (ì¼ê¸‰, ìë™ ê³„ì‚°) ğŸ”¥                   â”‚  â”‚
â”‚  â”‚  - isLate, isEarlyLeave (ìë™ íŒë‹¨)                â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ salary (ì§‘ê³„ ê²°ê³¼ë§Œ ì €ì¥)                            â”‚  â”‚
â”‚  â”‚  - status: 'unconfirmed' | 'confirmed' | 'paid'     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ contracts (ê³„ì•½ ì •ë³´)                                â”‚  â”‚
â”‚  â”‚  - schedules: [{ day, startTime, endTime }]        â”‚  â”‚
â”‚  â”‚  - salaryType, salaryAmount                         â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ ë°ì´í„° íë¦„

### 1. ì¶œê·¼ ì²˜ë¦¬ (clockIn)

```
ì‚¬ìš©ì í´ë¦­ â†’ clockIn() í˜¸ì¶œ
              â†“
        ê³„ì•½ì„œ ì¡°íšŒ (contracts)
              â†“
     ìŠ¤ì¼€ì¤„ ì‹œê°„ ì¶”ì¶œ (scheduledStartTime, scheduledEndTime)
              â†“
        ì§€ê° ì—¬ë¶€ íŒë‹¨ (isLate)
              â†“
    Attendance ë¬¸ì„œ ìƒì„±
    {
      clockIn: Timestamp,
      scheduledStartTime: "09:00",
      scheduledEndTime: "18:00",
      isLate: false,
      status: "present"
    }
```

### 2. í‡´ê·¼ ì²˜ë¦¬ (clockOut) - The Brain ğŸ§ 

```
ì‚¬ìš©ì í´ë¦­ â†’ clockOut() í˜¸ì¶œ
              â†“
    Firestore Transaction ì‹œì‘
              â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ 1. Attendance ì¡°íšŒ      â”‚
    â”‚ 2. Contract ì¡°íšŒ        â”‚
    â”‚ 3. ì¼ê¸‰ ê³„ì‚° ì—”ì§„       â”‚
    â”‚    - workMinutes        â”‚
    â”‚    - overtimeMinutes    â”‚
    â”‚    - nightWorkMinutes   â”‚
    â”‚    - holidayWorkMinutes â”‚
    â”‚    - basePay            â”‚
    â”‚    - overtimePay        â”‚
    â”‚    - nightPay           â”‚
    â”‚    - holidayPay         â”‚
    â”‚    - dailyWage          â”‚
    â”‚ 4. ì¡°í‡´ ì—¬ë¶€ íŒë‹¨       â”‚
    â”‚ 5. ìƒíƒœ ì—…ë°ì´íŠ¸        â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“
    Attendance ë¬¸ì„œ ì—…ë°ì´íŠ¸ (ì›ìì )
    {
      clockOut: Timestamp,
      workMinutes: 480,
      basePay: 80000,
      overtimePay: 15000,
      dailyWage: 95000,
      isEarlyLeave: false,
      status: "present"
    }
              â†“
    Transaction ì»¤ë°‹ (ëª¨ë‘ ì„±ê³µ or ëª¨ë‘ ì‹¤íŒ¨)
```

### 3. ê¸‰ì—¬ ì¡°íšŒ - The Viewer ğŸ‘ï¸

```
ì‚¬ìš©ì í´ë¦­ â†’ loadSalaryList() í˜¸ì¶œ
              â†“
    ì§ì› ëª©ë¡ ì¡°íšŒ (users)
              â†“
    ê° ì§ì›ì˜ Attendance ì¡°íšŒ
    (date ë²”ìœ„: 2025-01-01 ~ 2025-01-31)
              â†“
    ë‹¨ìˆœ ì§‘ê³„ (sum)
    {
      totalBasePay = sum(basePay),
      totalOvertimePay = sum(overtimePay),
      totalNightPay = sum(nightPay),
      totalHolidayPay = sum(holidayPay),
      totalPay = sum(dailyWage)
    }
              â†“
    í™”ë©´ì— í‘œì‹œ
```

---

## ğŸ§© í•µì‹¬ ì»´í¬ë„ŒíŠ¸

### 1. AttendanceService (The Brain ğŸ§ )

**ì—­í• :** ì‹œìŠ¤í…œì˜ ì¤‘ì‹¬. ëª¨ë“  íŒŒìƒ ë°ì´í„°ë¥¼ ê³„ì‚°í•˜ê³  ì €ì¥.

**ì£¼ìš” í•¨ìˆ˜:**
- `clockIn()`: ì¶œê·¼ ì²˜ë¦¬ + ìŠ¤ì¼€ì¤„ ë§¤ì¹­ + ì§€ê° íŒë‹¨
- `clockOut()`: í‡´ê·¼ ì²˜ë¦¬ + ì¼ê¸‰ ìë™ ê³„ì‚°
- `calculateDailyWage()`: ì¼ê¸‰ ê³„ì‚° ì—”ì§„

**í•µì‹¬ ì›ì¹™:**
- íŠ¸ëœì­ì…˜ ì‚¬ìš© (ì›ìì  ì—…ë°ì´íŠ¸)
- ëª¨ë“  ê³„ì‚° ê²°ê³¼ë¥¼ DBì— ì €ì¥
- ì—ëŸ¬ ë°œìƒ ì‹œ ë¡¤ë°±

**ì½”ë“œ ì˜ˆì‹œ:**
```typescript
export async function clockOut(attendanceId: string): Promise<void> {
  await runTransaction(db, async (transaction) => {
    // 1. ë°ì´í„° ì¡°íšŒ
    const attendanceDoc = await transaction.get(attendanceRef);
    const contractSnap = await getDocs(contractQuery);
    
    // 2. ì¼ê¸‰ ê³„ì‚°
    const wageCalc = await calculateDailyWage(
      clockInTime,
      clockOutTime,
      date,
      contract
    );
    
    // 3. ì›ìì  ì—…ë°ì´íŠ¸
    transaction.update(attendanceRef, {
      clockOut: Timestamp.fromDate(clockOutTime),
      workMinutes: wageCalc.workMinutes,
      dailyWage: wageCalc.totalPay,
      // ...
    });
  });
}
```

### 2. SalaryService (The Viewer ğŸ‘ï¸)

**ì—­í• :** ë‹¨ìˆœ ì§‘ê³„ë§Œ ìˆ˜í–‰. ê³„ì‚°ì€ í•˜ì§€ ì•ŠìŒ.

**ì£¼ìš” í•¨ìˆ˜:**
- `getMonthlySalary()`: ì›”ë³„ ê¸‰ì—¬ ì§‘ê³„
- `subscribeMonthlySalary()`: ì‹¤ì‹œê°„ êµ¬ë…

**í•µì‹¬ ì›ì¹™:**
- ë³µì¡í•œ ê³„ì‚° ë¡œì§ ì—†ìŒ
- Attendanceì˜ dailyWageë¥¼ ë‹¨ìˆœ í•©ì‚°
- ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸ ì§€ì›

**ì½”ë“œ ì˜ˆì‹œ:**
```typescript
export async function getMonthlySalary(
  userId: string,
  companyId: string,
  yearMonth: string
): Promise<MonthlySalarySummary> {
  // 1. Attendance ì¡°íšŒ
  const attendances = await getDocs(attendanceQuery);
  
  // 2. ë‹¨ìˆœ ì§‘ê³„
  let totalPay = 0;
  attendances.forEach((att) => {
    totalPay += att.dailyWage || 0; // ì´ë¯¸ ê³„ì‚°ë˜ì–´ ìˆìŒ
  });
  
  return { totalPay };
}
```

### 3. useSalaryLogic (Hook)

**ì—­í• :** ê¸‰ì—¬ í˜ì´ì§€ ìƒíƒœ ê´€ë¦¬

**ì£¼ìš” ê¸°ëŠ¥:**
- ìë™ ì¡°íšŒ ì œê±° (ë²„íŠ¼ í´ë¦­ ì‹œì—ë§Œ)
- ì‹¤ì‹œê°„ êµ¬ë… ì˜µì…˜
- ë¬´í•œ ë£¨í”„ ì™„ì „ ì œê±°

**í•µì‹¬ ì›ì¹™:**
- useEffect ì˜ì¡´ì„± ë°°ì—´ ìµœì í™”
- onSnapshotìœ¼ë¡œ ì‹¤ì‹œê°„ ë™ê¸°í™”
- View-only (ê³„ì‚° ì—†ìŒ)

**ì½”ë“œ ì˜ˆì‹œ:**
```typescript
export function useSalaryLogic() {
  // âŒ ìë™ ì¡°íšŒ ì œê±°
  // useEffect(() => {
  //   loadSalaryList();
  // }, [selectedMonth]);
  
  // âœ… ë²„íŠ¼ í´ë¦­ ì‹œì—ë§Œ ì¡°íšŒ
  const loadSalaryList = useCallback(async () => {
    // ë‹¨ìˆœ ì§‘ê³„ë§Œ ìˆ˜í–‰
    const totalPay = attendances.reduce(
      (sum, att) => sum + (att.dailyWage || 0),
      0
    );
  }, [selectedMonth]);
  
  return { loadSalaryList };
}
```

---

## ğŸ”¥ í•µì‹¬ ê°œì„ ì‚¬í•­

### Before (ì´ì „ ë°©ì‹)

#### âŒ ë¬¸ì œì 
1. **ì¡°íšŒ ì‹œ ê³„ì‚°**: ê¸‰ì—¬ í˜ì´ì§€ì—ì„œ ë§¤ë²ˆ ë³µì¡í•œ ê³„ì‚° ìˆ˜í–‰
2. **ë¬´í•œ ë£¨í”„**: useEffect ì˜ì¡´ì„± ë°°ì—´ ì˜¤ë¥˜ë¡œ ë¬´í•œ ì¬ì¡°íšŒ
3. **ë°ì´í„° ë¶ˆì¼ì¹˜**: ê° ëª¨ë“ˆì´ ë…ë¦½ì ìœ¼ë¡œ ê³„ì‚°í•˜ì—¬ ê²°ê³¼ ìƒì´
4. **ì„±ëŠ¥ ì €í•˜**: 100ëª… ì¡°íšŒ ì‹œ 10ì´ˆ ì´ìƒ ì†Œìš”
5. **í‡´ê·¼ ë°ì´í„° ëˆ„ë½**: ì €ì¥ ì‹¤íŒ¨ ì‹œ UIë§Œ ë³€ê²½ë˜ì–´ ì¢€ë¹„ ë°ì´í„° ë°œìƒ

#### ì½”ë“œ ì˜ˆì‹œ
```typescript
// âŒ ì´ì „: ì¡°íšŒ ì‹œ ê³„ì‚° (ëŠë¦¼)
const loadSalary = async () => {
  const attendances = await getAttendances();
  
  // ë§¤ë²ˆ ë³µì¡í•œ ê³„ì‚°
  attendances.forEach(att => {
    const workHours = calculateWorkHours(att);
    const basePay = workHours * hourlyWage;
    const overtimePay = calculateOvertime(att);
    // ...
  });
};

// âŒ ë¬´í•œ ë£¨í”„ ë°œìƒ
useEffect(() => {
  loadSalary(); // í•¨ìˆ˜ê°€ ì˜ì¡´ì„±ì— ì—†ì–´ì„œ ë¬´í•œ ë£¨í”„
}, [selectedMonth, loadSalary]);
```

### After (ìƒˆ ë°©ì‹ - SSOT)

#### âœ… ê°œì„ ì‚¬í•­
1. **ì“°ê¸° ì‹œ ê³„ì‚°**: í‡´ê·¼ ì‹œì ì— ëª¨ë“  ê³„ì‚° ì™„ë£Œ
2. **ë¬´í•œ ë£¨í”„ ì œê±°**: ìë™ ì¡°íšŒ ë¹„í™œì„±í™”
3. **ë°ì´í„° ì¼ê´€ì„±**: Attendanceê°€ ë‹¨ì¼ ì§„ì‹¤ ì†ŒìŠ¤
4. **ì„±ëŠ¥ í–¥ìƒ**: 100ëª… ì¡°íšŒ ì‹œ 2ì´ˆ ì´ë‚´
5. **ì›ìì  ì—…ë°ì´íŠ¸**: íŠ¸ëœì­ì…˜ìœ¼ë¡œ ë¶€ë¶„ ì €ì¥ ë°©ì§€

#### ì½”ë“œ ì˜ˆì‹œ
```typescript
// âœ… ìƒˆ ë°©ì‹: í‡´ê·¼ ì‹œ ê³„ì‚° (ë¹ ë¦„)
const clockOut = async () => {
  await runTransaction(db, async (transaction) => {
    // í•œ ë²ˆë§Œ ê³„ì‚°í•˜ê³  ì €ì¥
    const dailyWage = calculateDailyWage(...);
    
    transaction.update(attendanceRef, {
      clockOut,
      dailyWage, // DBì— ì €ì¥
    });
  });
};

// âœ… ì¡°íšŒ ì‹œ ë‹¨ìˆœ ì§‘ê³„
const loadSalary = async () => {
  const attendances = await getAttendances();
  
  // ë‹¨ìˆœ í•©ì‚°ë§Œ
  const totalPay = attendances.reduce(
    (sum, att) => sum + att.dailyWage,
    0
  );
};

// âœ… ë¬´í•œ ë£¨í”„ ì œê±°
// ìë™ ì¡°íšŒ ë¹„í™œì„±í™”, ë²„íŠ¼ í´ë¦­ ì‹œì—ë§Œ
```

---

## ğŸ“Š ì„±ëŠ¥ ë¹„êµ

| í•­ëª© | Before | After | ê°œì„ ìœ¨ |
|------|--------|-------|--------|
| ê¸‰ì—¬ ì¡°íšŒ (100ëª…) | 10ì´ˆ | 2ì´ˆ | **80% ë‹¨ì¶•** |
| í‡´ê·¼ ì²˜ë¦¬ | 0.5ì´ˆ | 1ì´ˆ | íŠ¸ëœì­ì…˜ ì¶”ê°€ë¡œ ì•½ê°„ ì¦ê°€ |
| Firestore ì½ê¸° ë¹„ìš© | ë†’ìŒ (ë§¤ë²ˆ ê³„ì‚°) | ë‚®ìŒ (ì§‘ê³„ë§Œ) | **50% ì ˆê°** |
| ë¬´í•œ ë£¨í”„ | ë°œìƒ | **ì—†ìŒ** | - |
| ë°ì´í„° ì¼ê´€ì„± | ë‚®ìŒ | **ë†’ìŒ** | - |

---

## ğŸš€ ë°°í¬ ì²´í¬ë¦¬ìŠ¤íŠ¸

- [ ] ëª¨ë“  í…ŒìŠ¤íŠ¸ í†µê³¼ (SSOT_TESTING_GUIDE.md ì°¸ê³ )
- [ ] ì½˜ì†” ë¬´í•œ ë£¨í”„ ë¡œê·¸ ì—†ìŒ
- [ ] Firestore ê¶Œí•œ ì˜¤ë¥˜ ì—†ìŒ
- [ ] ì„±ëŠ¥ í…ŒìŠ¤íŠ¸ í†µê³¼
- [ ] Git commit & push
- [ ] README ì—…ë°ì´íŠ¸
- [ ] íŒ€ì› ê³µìœ 

---

## ğŸ“š ê´€ë ¨ ë¬¸ì„œ

- [í…ŒìŠ¤íŠ¸ ê°€ì´ë“œ](./SSOT_TESTING_GUIDE.md)
- [AttendanceService ì½”ë“œ](./services/attendanceService.ts)
- [SalaryService ì½”ë“œ](./services/salaryService.ts)
- [useSalaryLogic ì½”ë“œ](./hooks/admin/useSalaryLogic.ts)

---

## ğŸ‰ ìš”ì•½

**SSOT ì•„í‚¤í…ì²˜ì˜ í•µì‹¬:**

1. **Attendance = The Brain**: ëª¨ë“  ê³„ì‚°ì€ ì—¬ê¸°ì„œ
2. **Salary = The Viewer**: ë‹¨ìˆœ ì§‘ê³„ë§Œ
3. **Hooks = State Manager**: View-only, ê³„ì‚° ì—†ìŒ
4. **"ì“¸ ë•Œ ê³„ì‚°, ì½ì„ ë•Œ ì§‘ê³„"**: ì„±ëŠ¥ê³¼ ì¼ê´€ì„± ë™ì‹œ í™•ë³´

ì´ ì„¤ê³„ë¡œ **ë°ì´í„° ë¶ˆì¼ì¹˜, ë¬´í•œ ë£¨í”„, ì„±ëŠ¥ ì €í•˜** ë¬¸ì œë¥¼ ëª¨ë‘ í•´ê²°í–ˆìŠµë‹ˆë‹¤! ğŸš€
