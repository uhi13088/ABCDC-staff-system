<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ABC Staff System - ìŠ¤ë§ˆíŠ¸í•œ ì§ì› ê´€ë¦¬ì˜ ì‹œì‘</title>
  
  <!-- Favicon -->
  <link rel="icon" type="image/svg+xml" href="favicon.svg">
  
  <!-- Tailwind CSS CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  
  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
  
  <style>
    body {
      font-family: 'Inter', sans-serif;
    }
    
    /* ê·¸ë¼ë°ì´ì…˜ ë°°ê²½ */
    .gradient-bg {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    }
    
    .gradient-text {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    
    /* ì¸ê¸° í”Œëœ ê°•ì¡° íš¨ê³¼ */
    .popular-plan {
      transform: scale(1.05);
      box-shadow: 0 20px 60px rgba(102, 126, 234, 0.3);
    }
    
    /* ì• ë‹ˆë©”ì´ì…˜ */
    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(30px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    
    .fade-in-up {
      animation: fadeInUp 0.8s ease-out;
    }
    
    /* ëª¨ë‹¬ ìŠ¤íƒ€ì¼ */
    .modal-overlay {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      backdrop-filter: blur(4px);
      z-index: 9999;
      align-items: center;
      justify-content: center;
      padding: 20px;
    }
    
    .modal-content {
      background: white;
      border-radius: 16px;
      padding: 32px;
      max-width: 500px;
      width: 100%;
      box-shadow: 0 25px 50px rgba(0, 0, 0, 0.2);
      position: relative;
    }
  </style>
</head>
<body class="bg-gray-50">
  <!-- ë„¤ë¹„ê²Œì´ì…˜ -->
  <nav class="bg-white shadow-sm sticky top-0 z-50">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex justify-between items-center h-16">
        <div class="flex items-center">
          <svg class="w-8 h-8 text-purple-600" fill="currentColor" viewBox="0 0 24 24">
            <path d="M20 3H4v10c0 2.21 1.79 4 4 4h6c2.21 0 4-1.79 4-4v-3h2c1.11 0 2-.89 2-2V5c0-1.11-.89-2-2-2zm0 5h-2V5h2v3zM4 19h16v2H4z"/>
          </svg>
          <span class="ml-2 text-xl font-bold gradient-text">ABC Staff System</span>
        </div>
        <div class="flex items-center gap-4">
          <a href="admin-login.html" class="text-gray-600 hover:text-gray-900 font-medium">ê´€ë¦¬ì ë¡œê·¸ì¸</a>
          <a href="employee-login.html" class="bg-purple-600 text-white px-6 py-2 rounded-lg hover:bg-purple-700 transition font-medium">ì§ì› ë¡œê·¸ì¸</a>
        </div>
      </div>
    </div>
  </nav>

  <!-- íˆì–´ë¡œ ì„¹ì…˜ -->
  <section class="gradient-bg text-white py-20 lg:py-32">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center fade-in-up">
      <h1 class="text-4xl lg:text-6xl font-extrabold mb-6 leading-tight">
        ìŠ¤ë§ˆíŠ¸í•œ ì§ì› ê´€ë¦¬ì˜ ì‹œì‘
        <br />
        <span class="text-purple-200">ABC Staff System</span>
      </h1>
      <p class="text-lg lg:text-xl text-purple-100 mb-10 max-w-2xl mx-auto leading-relaxed">
        ê·¼íƒœ ê´€ë¦¬ë¶€í„° ê¸‰ì—¬ ê³„ì‚°ê¹Œì§€, ì§ì› ê´€ë¦¬ì˜ ëª¨ë“  ê²ƒì„ í•˜ë‚˜ì˜ í”Œë«í¼ì—ì„œ ê°„í¸í•˜ê²Œ ì²˜ë¦¬í•˜ì„¸ìš”.
        í´ë¼ìš°ë“œ ê¸°ë°˜ìœ¼ë¡œ ì–¸ì œ ì–´ë””ì„œë‚˜ ì ‘ê·¼ ê°€ëŠ¥í•©ë‹ˆë‹¤.
      </p>
      <div class="flex flex-col sm:flex-row gap-4 justify-center">
        <button onclick="openInviteCodeModal()" class="bg-white text-purple-600 px-8 py-4 rounded-lg hover:bg-gray-100 transition font-bold text-lg shadow-lg">
          ğŸŸï¸ ì´ˆëŒ€ ì½”ë“œë¡œ ì‹œì‘í•˜ê¸°
        </button>
        <a href="#pricing" class="bg-purple-800 bg-opacity-30 text-white px-8 py-4 rounded-lg hover:bg-opacity-50 transition font-bold text-lg border-2 border-white border-opacity-30">
          ìš”ê¸ˆì œ ë³´ê¸°
        </a>
      </div>
      
      <!-- ì£¼ìš” ê¸°ëŠ¥ ì•„ì´ì½˜ -->
      <div class="grid grid-cols-2 sm:grid-cols-4 gap-6 mt-16 max-w-4xl mx-auto">
        <div class="bg-white bg-opacity-10 backdrop-blur-sm p-6 rounded-xl">
          <div class="text-4xl mb-2">â°</div>
          <div class="font-semibold">ê·¼íƒœ ê´€ë¦¬</div>
        </div>
        <div class="bg-white bg-opacity-10 backdrop-blur-sm p-6 rounded-xl">
          <div class="text-4xl mb-2">ğŸ’°</div>
          <div class="font-semibold">ê¸‰ì—¬ ê³„ì‚°</div>
        </div>
        <div class="bg-white bg-opacity-10 backdrop-blur-sm p-6 rounded-xl">
          <div class="text-4xl mb-2">ğŸ“‹</div>
          <div class="font-semibold">ê³„ì•½ ê´€ë¦¬</div>
        </div>
        <div class="bg-white bg-opacity-10 backdrop-blur-sm p-6 rounded-xl">
          <div class="text-4xl mb-2">ğŸ“Š</div>
          <div class="font-semibold">ì‹¤ì‹œê°„ ë¶„ì„</div>
        </div>
      </div>
    </div>
  </section>

  <!-- ê°€ê²© ì •ì±…í‘œ (ë™ì  ë Œë”ë§) -->
  <section id="pricing" class="py-20 bg-gray-50">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="text-center mb-16 fade-in-up">
        <h2 class="text-3xl lg:text-5xl font-extrabold text-gray-900 mb-4">
          ê°„ë‹¨í•˜ê³  íˆ¬ëª…í•œ ìš”ê¸ˆì œ
        </h2>
        <p class="text-lg text-gray-600 max-w-2xl mx-auto">
          ì´ˆëŒ€ ì½”ë“œë¡œ ë°”ë¡œ ì‹œì‘í•˜ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê²°ì œ ì—†ì´ í”Œëœì„ ì²´í—˜í•´ë³´ì„¸ìš”.
        </p>
      </div>
      
      <!-- í”Œëœ ì¹´ë“œ ì»¨í…Œì´ë„ˆ (Firestoreì—ì„œ ë™ì  ë¡œë“œ) -->
      <div id="pricingContainer" class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-4 gap-6 max-w-7xl mx-auto">
        <!-- ë¡œë”© ìŠ¤í”¼ë„ˆ -->
        <div class="col-span-full text-center py-20">
          <div class="inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600"></div>
          <p class="mt-4 text-gray-600">ìš”ê¸ˆì œë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</p>
        </div>
      </div>
    </div>
  </section>

  <!-- í‘¸í„° -->
  <footer class="bg-gray-900 text-gray-300 py-12">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
      <div class="mb-4">
        <svg class="w-10 h-10 text-purple-400 mx-auto" fill="currentColor" viewBox="0 0 24 24">
          <path d="M20 3H4v10c0 2.21 1.79 4 4 4h6c2.21 0 4-1.79 4-4v-3h2c1.11 0 2-.89 2-2V5c0-1.11-.89-2-2-2zm0 5h-2V5h2v3zM4 19h16v2H4z"/>
        </svg>
      </div>
      <p class="text-sm">&copy; 2024 ABC Staff System. All rights reserved.</p>
      <p class="text-xs text-gray-500 mt-2">ìŠ¤ë§ˆíŠ¸í•œ ì§ì› ê´€ë¦¬ ì†”ë£¨ì…˜</p>
    </div>
  </footer>

  <!-- ì´ˆëŒ€ ì½”ë“œ ì…ë ¥ ëª¨ë‹¬ -->
  <div id="inviteCodeModal" class="modal-overlay">
    <div class="modal-content">
      <button onclick="closeInviteCodeModal()" class="absolute top-4 right-4 text-gray-400 hover:text-gray-600 text-2xl font-bold">&times;</button>
      
      <h2 class="text-2xl font-bold text-gray-900 mb-2">ğŸŸï¸ ì´ˆëŒ€ ì½”ë“œ ì…ë ¥</h2>
      <p class="text-gray-600 mb-6">ì´ˆëŒ€ ì½”ë“œë¥¼ ì…ë ¥í•˜ì‹œë©´ ìë™ìœ¼ë¡œ í”Œëœì´ í• ë‹¹ë©ë‹ˆë‹¤.</p>
      
      <form id="inviteCodeForm" onsubmit="verifyInviteCode(event)">
        <div class="mb-6">
          <label for="inviteCodeInput" class="block text-sm font-medium text-gray-700 mb-2">ì´ˆëŒ€ ì½”ë“œ</label>
          <input 
            type="text" 
            id="inviteCodeInput" 
            class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-600 focus:border-transparent text-center font-mono text-lg uppercase"
            placeholder="ì˜ˆ: ABC12345"
            required
            maxlength="12"
          />
          <p class="text-xs text-gray-500 mt-2">â€» ê´€ë¦¬ìë¡œë¶€í„° ë°›ì€ ì´ˆëŒ€ ì½”ë“œë¥¼ ì…ë ¥í•˜ì„¸ìš”</p>
        </div>
        
        <div id="inviteCodeResult" class="mb-4" style="display: none;"></div>
        
        <div class="flex gap-3">
          <button type="button" onclick="closeInviteCodeModal()" class="flex-1 bg-gray-200 text-gray-700 px-6 py-3 rounded-lg hover:bg-gray-300 transition font-medium">
            ì·¨ì†Œ
          </button>
          <button type="submit" class="flex-1 bg-purple-600 text-white px-6 py-3 rounded-lg hover:bg-purple-700 transition font-medium">
            í™•ì¸
          </button>
        </div>
      </form>
    </div>
  </div>

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
  
  <!-- Firebase ì„¤ì • -->
  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyCr3Tq2T7oy5rVlK1c33m_G0TlUWv0-g3k",
      authDomain: "abcdc-staff-system.firebaseapp.com",
      projectId: "abcdc-staff-system",
      storageBucket: "abcdc-staff-system.firebasestorage.app",
      messagingSenderId: "442207878284",
      appId: "1:442207878284:web:49b157573851b124d28fa9"
    };
    
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();
  </script>

  <!-- ëœë”© í˜ì´ì§€ JavaScript -->
  <script>
    /**
     * ê¶Œí•œ â†’ ì‚¬ëŒì´ ì½ì„ ìˆ˜ ìˆëŠ” ê¸°ëŠ¥ëª… ë³€í™˜
     */
    function getPermissionLabel(permission) {
      const permissionLabels = {
        'recipe.print': 'ë ˆì‹œí”¼ ì¸ì‡„ ğŸ“„',
        'recipe.view_secret': 'ë ˆì‹œí”¼ ë¹„ê³µê°œ í•„ë“œ ì¡°íšŒ ğŸ”’',
        'recipe.share_external': 'ë ˆì‹œí”¼ ì™¸ë¶€ ê³µìœ  ğŸ”—',
        'staff.manage_contract': 'ê³„ì•½ì„œ ê´€ë¦¬ ğŸ“',
        'staff.invite_email': 'ì´ë©”ì¼ ì´ˆëŒ€ ë°œì†¡ âœ‰ï¸',
        'staff.schedule_manage': 'ìŠ¤ì¼€ì¤„ ê´€ë¦¬ ğŸ“…',
        'data.export_all': 'ë°ì´í„° ì „ì²´ ë‚´ë³´ë‚´ê¸° ğŸ“Š',
        'data.bulk_update': 'ì¼ê´„ ì—…ë°ì´íŠ¸ âš¡'
      };
      return permissionLabels[permission] || permission;
    }

    /**
     * ë™ì  ê°€ê²©í‘œ ë Œë”ë§ (DB ê¸°ë°˜)
     */
    async function loadPricingPlans() {
      try {
        const plansSnapshot = await db.collection('subscription_plans')
          .where('isActive', '==', true)
          .orderBy('price', 'asc')
          .get();

        const container = document.getElementById('pricingContainer');
        
        if (plansSnapshot.empty) {
          container.innerHTML = `
            <div class="col-span-full text-center py-20">
              <p class="text-gray-600">í˜„ì¬ ì œê³µ ì¤‘ì¸ ìš”ê¸ˆì œê°€ ì—†ìŠµë‹ˆë‹¤.</p>
            </div>
          `;
          return;
        }

        let html = '';
        
        // ëˆ„ì  ê¶Œí•œ ì¶”ì  (ìƒìœ„ í”Œëœì¼ìˆ˜ë¡ í•˜ìœ„ í”Œëœ ê¶Œí•œ í¬í•¨)
        const allPlans = [];
        plansSnapshot.forEach(doc => {
          allPlans.push({ id: doc.id, ...doc.data() });
        });

        allPlans.forEach((plan, index) => {
          const isPopular = plan.isPopular === true;
          const maxUsersText = plan.maxUsers >= 9999 ? 'ë¬´ì œí•œ' : `ìµœëŒ€ ${plan.maxUsers}ëª…`;
          const description = plan.description || '';
          const permissions = Array.isArray(plan.permissions) ? plan.permissions : [];
          
          // ê¸°ë³¸ ê¸°ëŠ¥ (ëª¨ë“  í”Œëœ ê³µí†µ)
          const baseFeatures = [
            { text: 'âœ… ëª¨ë“  ê¸°ë³¸ ê¸°ëŠ¥ í¬í•¨', isBold: true },
            { text: 'íšŒì‚¬/ë¸Œëœë“œ/ë§¤ì¥ ê´€ë¦¬', isBold: false },
            { text: 'ì§ì› í”„ë¡œí•„ ê´€ë¦¬', isBold: false },
            { text: 'ë ˆì‹œí”¼ ê´€ë¦¬ (ê¸°ë³¸)', isBold: false },
            { text: 'ê³µì§€ì‚¬í•­ ê²Œì‹œíŒ', isBold: false }
          ];

          // ëˆ„ì  ê¶Œí•œ ê³„ì‚° (í˜„ì¬ í”Œëœê¹Œì§€ì˜ ëª¨ë“  ê¶Œí•œ)
          let accumulatedPermissions = [];
          for (let i = 0; i <= index; i++) {
            const currentPlanPermissions = Array.isArray(allPlans[i].permissions) ? allPlans[i].permissions : [];
            accumulatedPermissions = [...new Set([...accumulatedPermissions, ...currentPlanPermissions])];
          }

          // ì‹ ê·œ ê¶Œí•œ (ì´ì „ í”Œëœì— ì—†ë˜ ê¶Œí•œ)
          let previousPermissions = [];
          if (index > 0) {
            for (let i = 0; i < index; i++) {
              const prevPlanPerms = Array.isArray(allPlans[i].permissions) ? allPlans[i].permissions : [];
              previousPermissions = [...new Set([...previousPermissions, ...prevPlanPerms])];
            }
          }
          
          const newPermissions = permissions.filter(p => !previousPermissions.includes(p));

          // ê¶Œí•œì„ ê¸°ëŠ¥ ë¬¸êµ¬ë¡œ ë³€í™˜
          const permissionFeatures = accumulatedPermissions.map(perm => {
            const isNew = newPermissions.includes(perm);
            return {
              text: getPermissionLabel(perm),
              isBold: isNew // ì‹ ê·œ ê¸°ëŠ¥ì€ êµµê²Œ í‘œì‹œ
            };
          });

          const allFeatures = [...baseFeatures, ...permissionFeatures];

          // ë²„íŠ¼ í…ìŠ¤íŠ¸ ë¶„ê¸°
          const buttonText = plan.price === 0 ? 'ë¬´ë£Œë¡œ ì‹œì‘í•˜ê¸°' : 'ì§€ê¸ˆ ì‹œì‘í•˜ê¸°';
          
          html += `
            <div class="bg-white rounded-2xl shadow-lg overflow-hidden ${isPopular ? 'popular-plan border-4 border-purple-600 relative' : 'border border-gray-200'} transition-all duration-300 hover:shadow-xl">
              ${isPopular ? '<div class="absolute top-0 left-0 right-0 bg-gradient-to-r from-purple-600 to-purple-700 text-white text-center py-2 text-sm font-bold">â­ ì¶”ì²œ í”Œëœ</div>' : ''}
              
              <div class="p-6 ${isPopular ? 'pt-12' : ''}">
                <h3 class="text-2xl font-extrabold text-gray-900 mb-1">${plan.name}</h3>
                <p class="text-sm text-gray-500 mb-4 min-h-[40px]">${description}</p>
                
                <div class="mb-4">
                  <span class="text-4xl font-extrabold ${isPopular ? 'text-purple-600' : 'text-gray-900'}">
                    ${plan.price === 0 ? 'ë¬´ë£Œ' : plan.price.toLocaleString() + 'ì›'}
                  </span>
                  <span class="text-gray-600 text-base block mt-1">
                    ${plan.price === 0 ? 'ì˜êµ¬ ë¬´ë£Œ' : '/ ' + (plan.billingCycle === 'monthly' ? 'ì›”' : 'ë…„')}
                  </span>
                </div>
                
                <div class="mb-4 pb-4 border-b border-gray-200">
                  <span class="inline-block bg-purple-100 text-purple-700 px-3 py-1.5 rounded-full text-xs font-semibold">
                    ğŸ‘¥ ${maxUsersText}
                  </span>
                </div>
                
                <ul class="space-y-2.5 mb-6 min-h-[280px]">
                  ${allFeatures.map(feature => `
                    <li class="flex items-start text-sm">
                      <svg class="w-5 h-5 text-green-500 mr-2 flex-shrink-0 mt-0.5" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/>
                      </svg>
                      <span class="${feature.isBold ? 'font-bold text-gray-900' : 'text-gray-700'}">${feature.text}</span>
                    </li>
                  `).join('')}
                </ul>
                
                <button 
                  onclick="openInviteCodeModal()" 
                  class="w-full ${isPopular ? 'bg-gradient-to-r from-purple-600 to-purple-700 hover:from-purple-700 hover:to-purple-800' : 'bg-gray-900 hover:bg-gray-800'} text-white px-6 py-3 rounded-lg transition-all duration-200 font-bold text-base shadow-md hover:shadow-lg transform hover:-translate-y-0.5"
                >
                  ${buttonText}
                </button>
              </div>
            </div>
          `;
        });
        
        container.innerHTML = html;
        
      } catch (error) {
        console.error('í”Œëœ ë¡œë“œ ì‹¤íŒ¨:', error);
        document.getElementById('pricingContainer').innerHTML = `
          <div class="col-span-full text-center py-20">
            <p class="text-red-600 font-semibold mb-2">ìš”ê¸ˆì œë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.</p>
            <p class="text-sm text-gray-600 mb-4">${error.message}</p>
            <button onclick="loadPricingPlans()" class="bg-purple-600 text-white px-6 py-2 rounded-lg hover:bg-purple-700 transition">ë‹¤ì‹œ ì‹œë„</button>
          </div>
        `;
      }
    }

    /**
     * ì´ˆëŒ€ ì½”ë“œ ëª¨ë‹¬ ì—´ê¸°
     */
    function openInviteCodeModal() {
      document.getElementById('inviteCodeModal').style.display = 'flex';
      document.getElementById('inviteCodeInput').focus();
    }

    /**
     * ì´ˆëŒ€ ì½”ë“œ ëª¨ë‹¬ ë‹«ê¸°
     */
    function closeInviteCodeModal() {
      document.getElementById('inviteCodeModal').style.display = 'none';
      document.getElementById('inviteCodeForm').reset();
      document.getElementById('inviteCodeResult').style.display = 'none';
    }

    /**
     * ì´ˆëŒ€ ì½”ë“œ ê²€ì¦
     */
    async function verifyInviteCode(event) {
      event.preventDefault();
      
      const code = document.getElementById('inviteCodeInput').value.trim().toUpperCase();
      const resultDiv = document.getElementById('inviteCodeResult');
      
      if (!code) {
        resultDiv.innerHTML = '<p class="text-red-600 text-sm">ì´ˆëŒ€ ì½”ë“œë¥¼ ì…ë ¥í•˜ì„¸ìš”.</p>';
        resultDiv.style.display = 'block';
        return;
      }
      
      resultDiv.innerHTML = '<p class="text-blue-600 text-sm">í™•ì¸ ì¤‘...</p>';
      resultDiv.style.display = 'block';
      
      try {
        // Firestoreì—ì„œ ì´ˆëŒ€ ì½”ë“œ ê²€ìƒ‰
        const codesSnapshot = await db.collection('invitation_codes')
          .where('code', '==', code)
          .limit(1)
          .get();
        
        if (codesSnapshot.empty) {
          resultDiv.innerHTML = '<p class="text-red-600 text-sm">âŒ ìœ íš¨í•˜ì§€ ì•Šì€ ì´ˆëŒ€ ì½”ë“œì…ë‹ˆë‹¤.</p>';
          return;
        }
        
        const codeDoc = codesSnapshot.docs[0];
        const codeData = codeDoc.data();
        
        // ì´ë¯¸ ì‚¬ìš©ëœ ì½”ë“œì¸ì§€ í™•ì¸
        if (codeData.isUsed) {
          resultDiv.innerHTML = '<p class="text-red-600 text-sm">âŒ ì´ë¯¸ ì‚¬ìš©ëœ ì´ˆëŒ€ ì½”ë“œì…ë‹ˆë‹¤.</p>';
          return;
        }
        
        // í”Œëœ ì •ë³´ ê°€ì ¸ì˜¤ê¸°
        const planDoc = await db.collection('subscription_plans').doc(codeData.linkedPlanId).get();
        
        if (!planDoc.exists) {
          resultDiv.innerHTML = '<p class="text-red-600 text-sm">âŒ ì—°ê²°ëœ í”Œëœì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</p>';
          return;
        }
        
        const planData = planDoc.data();
        
        // ì´ˆëŒ€ ì½”ë“œì™€ í”Œëœ ì •ë³´ë¥¼ ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì— ì €ì¥
        localStorage.setItem('inviteCode', code);
        localStorage.setItem('inviteCodeId', codeDoc.id);
        localStorage.setItem('planId', codeData.linkedPlanId);
        localStorage.setItem('planName', planData.name);
        
        resultDiv.innerHTML = `<p class="text-green-600 text-sm">âœ… ìœ íš¨í•œ ì´ˆëŒ€ ì½”ë“œì…ë‹ˆë‹¤! (í”Œëœ: ${planData.name})</p>`;
        
        // 2ì´ˆ í›„ íšŒì›ê°€ì… í˜ì´ì§€ë¡œ ì´ë™
        setTimeout(() => {
          window.location.href = 'employee-register.html';
        }, 2000);
        
      } catch (error) {
        console.error('ì´ˆëŒ€ ì½”ë“œ ê²€ì¦ ì‹¤íŒ¨:', error);
        resultDiv.innerHTML = '<p class="text-red-600 text-sm">âŒ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.</p>';
      }
    }

    // í˜ì´ì§€ ë¡œë“œ ì‹œ í”Œëœ ëª©ë¡ ë¡œë“œ
    document.addEventListener('DOMContentLoaded', () => {
      loadPricingPlans();
    });

    // ëª¨ë‹¬ ì™¸ë¶€ í´ë¦­ ì‹œ ë‹«ê¸°
    document.getElementById('inviteCodeModal').addEventListener('click', (e) => {
      if (e.target.id === 'inviteCodeModal') {
        closeInviteCodeModal();
      }
    });
  </script>
</body>
</html>
